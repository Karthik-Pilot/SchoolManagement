{% extends "base.html" %}
{% block title %}Attendance Report{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold text-slate-900 mb-6">Student Attendance Report</h1>
<form method="get" class="mb-6 bg-white rounded shadow border p-4">
    <label class="block text-sm font-medium">Start Date</label>
    <input type="date" name="start" value="{{ start or '' }}" class="w-full rounded border px-3 py-2" required>
    <label class="block text-sm font-medium mt-2">End Date</label>
    <input type="date" name="end" value="{{ end or '' }}" class="w-full rounded border px-3 py-2" required>
    <label class="block text-sm font-medium mt-2">Group By</label>
    <select name="group_by" class="w-full rounded border px-3 py-2">
        <option value="month">Month</option>
        <option value="week">Week</option>
        <option value="year">Year</option>
    </select>
    <button type="submit" class="rounded bg-primary-600 px-4 py-2 text-white mt-4">Generate</button>
</form>
{% if rows %}
<table class="min-w-full bg-white rounded shadow border">
    <thead class="bg-slate-50"><tr><th class="px-4 py-3 text-left">Period</th><th class="px-4 py-3 text-left">Total</th><th class="px-4 py-3 text-left">Present</th><th class="px-4 py-3 text-left">Absent</th><th class="px-4 py-3 text-left">Late</th><th class="px-4 py-3 text-left">Percent</th></tr></thead>
    <tbody>
    {% for r in rows %}
    <tr><td class="px-4 py-3">{{ r.period }}</td><td class="px-4 py-3">{{ r.total }}</td><td class="px-4 py-3">{{ r.present }}</td><td class="px-4 py-3">{{ r.absent }}</td><td class="px-4 py-3">{{ r.late }}</td><td class="px-4 py-3">{{ r.percentage }}%</td></tr>
    {% endfor %}
    </tbody>
</table>
<p class="mt-2"><a href="{{ url_for('reports.attendance') }}?start={{ start }}&end={{ end }}&group_by={{ group_by }}&student_id={{ student_id or '' }}&class_id={{ class_id or '' }}&export=csv" class="text-primary-600 hover:underline">Export CSV</a></p>
{% endif %}
<a href="{{ url_for('reports.index') }}" class="text-primary-600 hover:underline mt-4 block">Back to Reports</a>
{% endblock %}
